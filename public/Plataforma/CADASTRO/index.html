<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="assets/style.css">
    <title>Cadastre-se</title>
    <link rel="icon" href="assets/sergio.usa.na.aba.ico">
</head>

<body>
    <div class="container-form">
        <div class="area-logo">
            <div class="box-logo">
                <h2 class="titulo-logo">Bem-Vindo a GuardTech+</h2>
                <div class="logo">
                    <img src="assets/logo sem (claro) sem escrita 1.png" alt="">
                </div>
                <p class="flush"><a href="../SITE/index.html">Voltar</a></p>
            </div>
        </div>
        <div class="area-form">
            <div class="desc-form">
                <p class="titulo-form">Cadastre-se</p>
            </div>
            <div class="form">
                <input type="text" id="input_empresa" placeholder="EMPRESA">
                <div class="box-endereco">
                    <input name="cep" onkeyup="showCep()" type="text" id="input_cep" size="10" maxlength="9"
                        placeholder="CEP">
                    <input type="text" id="input_num" placeholder="NUMERO">
                </div>
                <small class="alert" id="alert_cep"></small>
                <input type="text" id="input_logradouro" placeholder="LOGRADOURO">
                <input type="text" id="input_bairro" placeholder="BAIRRO">
                <input type="text" id="input_cidade" placeholder="CIDADE">
                <small class="alert" id="alert_cnpj">CNPJ invalido!</small>
                <input type="text" onkeyup="showCNPJ()" id="input_cnpj" placeholder="CNPJ">
            </div>
            <div class="area-button">
                <button onclick="cad();salvarNaSessionStorage()">Cadastrar</button>
            </div>
        </div>
    </div>

    <script src="assets/js/cad.js"></script>

    <script>


        const cep = document.querySelector('#input_cep')
        const logradouro = document.querySelector('#input_logradouro')
        const cidade = document.querySelector('#input_cidade')
        const bairro = document.querySelector('#input_bairro')
        const mensagem = document.querySelector('#alert_cep')


        const CaracteresPermitidos = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '-']

        function clearInput() {
            logradouro.value = ''
            cidade.value = ''
            bairro.value = ''
        }

        cep.addEventListener('focusout', async () => {

            let confirmacaoCep = false

            // Verificando o campo CEP

            if (cep.value.length >= 8 && cep.value.length <= 9) {
                for (let numeroChar = 0; numeroChar < cep.value.length; numeroChar++) {
                    let caracter = cep.value[numeroChar]

                    if (CaracteresPermitidos.indexOf(caracter) != -1) {
                        confirmacaoCep = true;
                    } else {
                        mensagem.style.display = 'block'
                        mensagem.innerHTML = 'CEP Inválido!';
                        setTimeout(() => {
                            mensagem.style.display = 'none'
                            mensagem.innerHTML = ''
                        }, 5000)
                        clearInput();
                        return;
                    }
                }
            } else {
                mensagem.style.display = 'block'
                mensagem.innerHTML = 'CEP Inválido!';
                setTimeout(() => {
                    mensagem.style.display = 'block'
                    mensagem.innerHTML = ''
                }, 5000)
                clearInput()
            }


            if (confirmacaoCep) {

                mensagem.style.display = 'none'



                const response = await fetch(`https://viacep.com.br/ws/${cep.value}/json/`)

                const responseCep = await response.json();

                logradouro.value = responseCep.logradouro;
                cidade.value = responseCep.localidade;
                bairro.value = responseCep.bairro;

                logradouro.setAttribute('readonly' , '')
                cidade.setAttribute('readonly' , '')
                bairro.setAttribute('readonly', '')
            }


        })
            //CRIANDO VARIAVEIS BOOLEANAS PARA VALIDAÇÃO
        //     let temMaiscula = false;
        //     let temMinuscula = false;
        //     let temNum = false;
        //     let temEspecial = false;


        //     //CRIANDO ARRAY PARA VALORES ESPECIAIS
        //     let especiais = ['!', '@', '#', '$', '%', '^', '&', '*', '(', ')', '_', '+', '-', '=', '[', ']', '{', '}', '|', ';', ':', ',', '.', '<', '>', '?'];

        //     //LIMPANDO CAMPO DE ALERT DA SENHA
        //     alert_senha.innerHTML = '';

        //     alert_cnpj.innerHTML = '';

        //     //FOR PARA VALIDAÇÃO DA SENHA
        //     for (let posicaoChar = 0; posicaoChar < senha.length; posicaoChar++) {
        //         let letra = senha[posicaoChar];

        //         if (letra >= 'A' && letra <= 'Z') {
        //             temMaiscula = true;
        //         }

        //         if (letra >= 'a' && letra <= 'z') {
        //             temMinuscula = true;
        //         }

        //         if (letra >= '0' && letra <= '9') {
        //             temNum = true;
        //         }

        //         if (especiais.indexOf(letra) != -1) {
        //             temEspecial = true;
        //         }

        //         if (temEspecial && temNum && temMinuscula && temMaiscula) {
        //             alert('Usuário cadastrado com sucesso')
        //             break;
        //         }
        //     }

        //     if (!temMaiscula) {
        //         alert_senha.style.display = 'block';
        //         alert_senha.innerHTML = 'A senha deve conter pelo menos uma letra maiúscula';
        //     }

        //     if (!temMinuscula) {
        //         alert_senha.style.display = 'block';
        //         alert_senha.innerHTML = 'A senha deve conter pelo menos uma letra minúscula';
        //     }

        //     if (!temNum) {
        //         alert_senha.style.display = 'block';
        //         alert_senha.innerHTML = 'A senha deve conter pelo menos um número';
        //     }

        //     if (!temEspecial) {
        //         alert_senha.style.display = 'block';
        //         alert_senha.innerHTML = 'A senha deve conter pelo menos 1 caractere especial';
        //     }

        //     if (temMaiscula && temMinuscula && temNum && temEspecial && cpfValido) {
        //         alert_senha.innerHTML = '';
        //     }
        // }


        // function showEmail() {
        //     const email = input_email.value;

        //     alert_email.style.display = 'block'

        //     if (email.indexOf('@') != - 1) {
        //         alert_email.style.display = 'none'
        //     }
        // }


        function showCNPJ() {
            const cnpj = input_cnpj.value;


            if (cnpj == '' || cnpj[2] != '.' || cnpj[6] != '.' || cnpj[15] != '-' || cnpj[10] != '/' || cnpj.indexOf('0001') <= cnpj[10]) {
                alert_cnpj.style.display = 'block'
            } else {
                alert_cnpj.style.display = 'none'
            }

        }

        // function showCep() {
        //     const cep = input_cep.value;

        //     if (cep == '' || cep.length != 9) {
        //         alert_cep.style.display = 'block'
        //     } else {
        //         alert_cep.style.display = 'none'
        //     }

        // }


        // function showConfirm() {
        //     const senha = input_senha.value;
        //     const confirm = input_confirm.value;

        //     if (senha != confirm) {
        //         alert_confirm.style.display = 'block'
        //     } else {
        //         alert_confirm.style.display = 'none'
        //     }
        // }
    </script>